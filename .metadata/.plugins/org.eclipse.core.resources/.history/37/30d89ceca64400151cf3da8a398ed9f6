package com.sample.auth;

import java.io.PrintWriter;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.sample.models.*;
import com.sample.database.DatabaseConnection;

public class RegisterUser {
	
	public void createUser(HttpServletRequest request, HttpServletResponse response) throws Exception
	{
		 byte[] zeros = {
                 (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00,
                 (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00,
                 (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00,
                 (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00
          };
          byte[] initializationVector_ = new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}; 
         
        String zeroes = new sun.misc.BASE64Encoder().encode(zeros);
        String iv = new sun.misc.BASE64Encoder().encode(initializationVector_);
        System.out.println("Zeros = "+zeroes);
        System.out.println("Initialization Vextor = "+iv);
          
		String userName = request.getParameter("username");
		String password = request.getParameter("password");
		response.setContentType("application/json");
    	PrintWriter out = response.getWriter();
		if (null != userName && null != password){
			DatabaseConnection db = DatabaseConnection.getInstance();
			UserModel um = new UserModel();
			um.setUserName(userName);
			um.setPassword(password);
			StatusModel sm = db.createUserName(um);
			out.print("{\"statusCode\":"+sm.getStatusCode()+",\"statusMessage\":"+sm.getStatusMessage()+"}");
			out.flush();
		}else{
			out.print("{\"statusCode\":\"1111\",\"statusMessage\":\"Empty user Input\"}");
	    	out.flush();
		}
	}
}
